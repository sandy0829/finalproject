{
    "collab_server" : "",
    "contents" : "---\ntitle: \"台灣各地區登革熱分析\"\noutput: github_document\n---\n\n##讀入資料\n```{r}\n#這是R Code Chunk\nlibrary(readr)\n#99~106年高雄登革熱資料\nMosIndex_Kaohsiung <- read_csv(\"C:/Users/user/Downloads/MosIndex_Kaohsiung.csv\")\n#104年高雄各地區各月份病例資料\nX104dengueinfection <- read_csv(\"C:/Users/user/Downloads/104dengueinfection.csv\")\n#台南市、高雄市、屏東縣快篩診所資料\nns1hosp_20160603 <- read_csv(\"C:/Users/user/Downloads/ns1hosp_20160603.csv\")\n#99~106年全台登革熱資料\nMosIndex_All <- read_csv(\"C:/Users/user/Downloads/MosIndex_All.csv\")\n#104年全台各鄉鎮市區人口密度\nopendata104N010 <- read_csv(\"C:/Users/user/Downloads/opendata104N010.csv\")\n```\n\n##資料處理與清洗、資料視覺化(99~106年全台登革熱資料)\n```{r}\n#這是R Code Chunk\nlibrary(dplyr)\nMosIndex_Allc<-select(MosIndex_All,Date:AreaType)\nMosIndex_Allc<-MosIndex_Allc[complete.cases(MosIndex_Allc),]\nMosIndex_Allc$VillageLon<-as.numeric(MosIndex_Allc$VillageLon)\nMosIndex_Allc$VillageLat<-as.numeric(MosIndex_Allc$VillageLat)\nMosIndex_Allc2010<-MosIndex_Allc[grepl(\"2010\",MosIndex_Allc$Date),]\nMosIndex_Allc2011<-MosIndex_Allc[grepl(\"2011\",MosIndex_Allc$Date),]\nMosIndex_Allc2012<-MosIndex_Allc[grepl(\"2012\",MosIndex_Allc$Date),]\nMosIndex_Allc2013<-MosIndex_Allc[grepl(\"2013\",MosIndex_Allc$Date),]\nMosIndex_Allc2014<-MosIndex_Allc[grepl(\"2014\",MosIndex_Allc$Date),]\nMosIndex_Allc2015<-MosIndex_Allc[grepl(\"2015\",MosIndex_Allc$Date),]\nMosIndex_Allc2016<-MosIndex_Allc[grepl(\"2016\",MosIndex_Allc$Date),]\nMosIndex_Allc2017<-MosIndex_Allc[grepl(\"2017\",MosIndex_Allc$Date),]\nlibrary(ggmap)\nTaiwanmap <- get_map(location = \"Taiwan\", zoom = 8)\ndensityMap0<-ggmap(Taiwanmap,extent = \"device\")+ \n  geom_density2d(data = MosIndex_Allc2010, aes(x = VillageLon, y = VillageLat), size = 0.3)+\n  stat_density2d(data = MosIndex_Allc2010, \n                 aes(x = VillageLon, y = VillageLat, \n                     fill = ..level.., alpha = ..level..), \n                 size = 0.01, bins = 16, geom = \"polygon\") + \n  scale_fill_gradient(low = \"green\", \n                      high = \"red\", guide = FALSE) + \n  scale_alpha(range = c(0, 0.3), guide = FALSE)\ndensityMap0\nTaiwanmap <- get_map(location = \"Taiwan\", zoom = 8)\ndensityMap1<-ggmap(Taiwanmap,extent = \"device\")+ \n  geom_density2d(data = MosIndex_Allc2011, aes(x = VillageLon, y = VillageLat), size = 0.3)+\n  stat_density2d(data = MosIndex_Allc2011, \n                 aes(x = VillageLon, y = VillageLat, \n                     fill = ..level.., alpha = ..level..), \n                 size = 0.01, bins = 16, geom = \"polygon\") + \n  scale_fill_gradient(low = \"green\", \n                      high = \"red\", guide = FALSE) + \n  scale_alpha(range = c(0, 0.3), guide = FALSE)\ndensityMap1\nTaiwanmap <- get_map(location = \"Taiwan\", zoom = 8)\ndensityMap2<-ggmap(Taiwanmap,extent = \"device\")+ \n  geom_density2d(data = MosIndex_Allc2012, aes(x = VillageLon, y = VillageLat), size = 0.3)+\n  stat_density2d(data = MosIndex_Allc2012, \n                 aes(x = VillageLon, y = VillageLat, \n                     fill = ..level.., alpha = ..level..), \n                 size = 0.01, bins = 16, geom = \"polygon\") + \n  scale_fill_gradient(low = \"green\", \n                      high = \"red\", guide = FALSE) + \n  scale_alpha(range = c(0, 0.3), guide = FALSE)\ndensityMap2\nTaiwanmap <- get_map(location = \"Taiwan\", zoom = 8)\ndensityMap3<-ggmap(Taiwanmap,extent = \"device\")+ \n  geom_density2d(data = MosIndex_Allc2013, aes(x = VillageLon, y = VillageLat), size = 0.3)+\n  stat_density2d(data = MosIndex_Allc2013, \n                 aes(x = VillageLon, y = VillageLat, \n                     fill = ..level.., alpha = ..level..), \n                 size = 0.01, bins = 16, geom = \"polygon\") + \n  scale_fill_gradient(low = \"green\", \n                      high = \"red\", guide = FALSE) + \n  scale_alpha(range = c(0, 0.3), guide = FALSE)\ndensityMap3\ndensityMap4<-ggmap(Taiwanmap,extent = \"device\")+ \n  geom_density2d(data = MosIndex_Allc2014, aes(x = VillageLon, y = VillageLat), size = 0.3)+\n  stat_density2d(data = MosIndex_Allc2014, \n                 aes(x = VillageLon, y = VillageLat, \n                     fill = ..level.., alpha = ..level..), \n                 size = 0.01, bins = 16, geom = \"polygon\") + \n  scale_fill_gradient(low = \"green\", \n                      high = \"red\", guide = FALSE) + \n  scale_alpha(range = c(0, 0.3), guide = FALSE)\ndensityMap4\nTaiwanmap <- get_map(location = \"Taiwan\", zoom = 8)\ndensityMap5<-ggmap(Taiwanmap,extent = \"device\")+ \n  geom_density2d(data = MosIndex_Allc2015, aes(x = VillageLon, y = VillageLat), size = 0.3)+\n  stat_density2d(data = MosIndex_Allc2015, \n                 aes(x = VillageLon, y = VillageLat, \n                     fill = ..level.., alpha = ..level..), \n                 size = 0.01, bins = 16, geom = \"polygon\") + \n  scale_fill_gradient(low = \"green\", \n                      high = \"red\", guide = FALSE) + \n  scale_alpha(range = c(0, 0.3), guide = FALSE)\ndensityMap5\nTaiwanmap <- get_map(location = \"Taiwan\", zoom = 8)\ndensityMap6<-ggmap(Taiwanmap,extent = \"device\")+ \n  geom_density2d(data = MosIndex_Allc2016, aes(x = VillageLon, y = VillageLat), size = 0.3)+\n  stat_density2d(data = MosIndex_Allc2016, \n                 aes(x = VillageLon, y = VillageLat, \n                     fill = ..level.., alpha = ..level..), \n                 size = 0.01, bins = 16, geom = \"polygon\") + \n  scale_fill_gradient(low = \"green\", \n                      high = \"red\", guide = FALSE) + \n  scale_alpha(range = c(0, 0.3), guide = FALSE)\ndensityMap6\nTaiwanmap <- get_map(location = \"Taiwan\", zoom = 8)\ndensityMap7<-ggmap(Taiwanmap,extent = \"device\")+ \n  geom_density2d(data = MosIndex_Allc2017, aes(x = VillageLon, y = VillageLat), size = 0.3)+\n  stat_density2d(data = MosIndex_Allc2017, \n                 aes(x = VillageLon, y = VillageLat, \n                     fill = ..level.., alpha = ..level..), \n                 size = 0.01, bins = 16, geom = \"polygon\") + \n  scale_fill_gradient(low = \"green\", \n                      high = \"red\", guide = FALSE) + \n  scale_alpha(range = c(0, 0.3), guide = FALSE)\ndensityMap7\n```\n\n##資料處理與清洗、資料視覺化(99~106年高雄登革熱資料)\n```{r}\nlibrary(dplyr)\nMosIndex_Kaohsiungc<-select(MosIndex_Kaohsiung,Date:AreaType)\nMosIndex_Kaohsiungc2015<-MosIndex_Kaohsiungc[grepl(\"2015\",MosIndex_Kaohsiungc$Date),]\nMosIndex_Kaohsiungc2016<-MosIndex_Kaohsiungc[grepl(\"2016\",MosIndex_Kaohsiungc$Date),]\nlibrary(ggmap)\nkhcmap <- get_map(location ='Kaohsiung', \n                 zoom = 10,\n                 language = \"zh-TW\", maptype = 'roadmap')\nkhcmap1 <- ggmap(khcmap)+ \n  geom_point(data=MosIndex_Kaohsiungc, \n             aes(x=VillageLon, y=VillageLat),colour=\"red\")\nkhcmap1\n```\n##資料處理與清洗、資料視覺化(104年高雄各地區各月份病例資料)\n```{r}\nX104dengueinfectionC<-select(X104dengueinfection,行政區:`12月`)\nlibrary(reshape2)\nX104dengueinfectionM<-melt(X104dengueinfectionC,id.vars = \"行政區\")\nX104dengueinfectionM1<-X104dengueinfectionM[grepl(\"區\",X104dengueinfectionM$行政區),]\n#104年各月份高雄地區的病例數\ntest<-group_by(X104dengueinfectionM1,variable) %>%\n  summarise(次數=sum(value,na.rm=T))%>%\n  arrange(desc(次數))\ntest\nggplot()+geom_bar(data=test,aes(x= variable,y= 次數),\n                  stat = \"identity\")+xlab(\"月份\")\n#104年高雄各地區的總病例\ntest1<-group_by(X104dengueinfectionM1,.dots=行政區) %>%\n summarise(病例=sum(value,na.rm=T)) %>%\n    arrange(desc(病例))\ntest1<-rename(test1,site_id=.dots)\ntest1\n```\n##資料處理與清洗、資料視覺化(台南市、高雄市、屏東縣快篩診所資料)\n```{r}\nns1hosp_20160603K<- ns1hosp_20160603[grep(\"高雄市\",ns1hosp_20160603$city),]\n#登革熱快篩所與病例分布\nlibrary(ggmap)\nKaohsiungmap <- get_map(location = \"Kaohsiung\", zoom = 10,\n                        language = \"zh-TW\", maptype = \"roadmap\")\n#紅色是病例，綠色是快篩所\nKaohsiungmap0 <- ggmap(Kaohsiungmap)+ \n  geom_point(data=MosIndex_Kaohsiungc2015, \n             aes(x = VillageLon, y = VillageLat),\n             colour=\"red\",size=1.2)+\n  geom_point(data=ns1hosp_20160603K, \n             aes(x = lng, y = lat),\n             colour=\"green\",size=1.2)\nKaohsiungmap0\n```\n##資料處理與清洗、資料視覺化(104年全台各鄉鎮市區人口密度)\n```{r}\nopendata104N010C<-opendata104N010[grepl(\"高雄市\",opendata104N010$site_id),]\nopendata104N010C<-opendata104N010C[complete.cases(opendata104N010C$statistic_yyy),]\nopendata104N010C$site_id<-substr(opendata104N010C$site_id,start = 4,stop = 7)\na<-full_join(opendata104N010C,test1,by=\"site_id\")\na<-mutate(a,盛行率=病例/as.numeric(people_total))\n```",
    "created" : 1496663143860.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2797754133",
    "id" : "A8D75AB",
    "lastKnownWriteTime" : 1497110461,
    "last_content_update" : 1497110461098,
    "path" : "~/GitHub/台灣各地區登革熱分析/finalproject/期末報告/README.Rmd",
    "project_path" : "README.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}